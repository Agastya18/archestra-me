<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>wasmer.js demo</title>
  <script defer type="module">
    import { init, Wasmer } from "https://unpkg.com/@wasmer/sdk@latest/dist/index.mjs";

    async function runNode() {
      await init();

      // Use the official Node.js WASM package from Wasmer registry
      const packageName = "saghul/quickjs";
      const pkg = await Wasmer.fromRegistry(packageName);

      console.log(pkg.entrypoint, pkg.commands.qjs);

      // Run a simple Node.js script
      const instance = await pkg.entrypoint.run({
        args: ["-e", "console.log('Ciao from Node.js WASM Jersey!')"],
      });

      const { code, stdout, stderr } = await instance.wait();

      // Output to the page
      document.getElementById('output').textContent =
        `Node.js exited with code ${code}\n` +
        `stdout:\n${stdout}\n` +
        (stderr ? `stderr:\n${stderr}` : "");
    }

    runNode();
  </script>
</head>
<body>
  <h1>wasmer.js demo</h1>
  <pre id="output"></pre>
</body>
</html>
